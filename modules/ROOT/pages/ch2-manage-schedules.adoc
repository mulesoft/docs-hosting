= Manage App Schedules
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]

include::partial$feature-availability.adoc[tag=featureUnavailable]


*THIS IS CH 1.0 PLACEHOLDER CONTENT UNTIL THE UI IS AVAILABLE* 


You can use Runtime Manager to view and control the Scheduler components within the flows in your deployed applications, all without changing the running application.

From the *Schedules* tab, you can:

* View the schedules in your running application.
* Change the schedules in your application at runtime without redeploying.
* Run the scheduled job immediately, without changing the schedule.
* Disable or enable the schedule for a flow.

The CloudHub 2.0 scheduler reads the job configuration every time it runs.
When you update the scheduler configuration, the change takes effect the next time the scheduler runs.

[NOTE]
All schedules are based in the UTC timezone, regardless of the geographic region where you deploy the app.

*Is this applicable for CH2?*

For multi-replica apps, CloudHub 2.0 guarantees that the schedule trigger executes on a single replica.
However, subsequent triggers might execute on a different replica.
CloudHub 2.0 distributes multiple concurrent schedules across replicas.

[NOTE]
You cannot manage CloudHub 2.0 schedules using scripts.
Use the *Schedules* tab or the CloudHub 2.0 API to manage CloudHub 2.0 schedules.

== Schedule Trigger Timing

*Do these still apply with CloudHub 2.0?*

When designing the schedule, consider the following:

* Plan for high availability during network failures, infrastructure restarts due to hardware issues or scheduled maintenance, and security updates.
+
During service updates or security patching, CloudHub 2.0 waits two minutes for existing schedules to complete.
After two minutes, CloudHub 2.0 retriggers any incomplete schedules.
+
To avoid retriggers with long-running schedules, make sure that the app executes the flow idempotently.
* If a scheduled job is not triggered because the application is not running,
CloudHub 2.0 triggers the job as soon as it restarts.
* When a Mule 4.x app uses a schedule to trigger a flow with subflow, the scheduler waits until both main flow and subflow complete before scheduling the next run.
+
Flow names can contain only letters (a-zA-Z), numbers (0-9), hyphen (-), underscore (_ ), and period (.) characters.


== Prerequisites

To use the scheduling feature in Runtime Manager, deploy an application that includes one or more Scheduler elements:

image::ch2-scheduler-studio.png[Scheduler component in the Anypoint Studio canvas]

You can download this example app from Exchange.
For information, see xref:ch2-deploy.adoc#download-a-test-app-from-exchange[Download a Test App from Exchange].

== View and Manage Application Schedules in Runtime Manager

After deploying an app to CloudHub 2.0, view and manage the Scheduler elements in Runtime Manager:

// SELECT RTM APPS SHARED
include::partial$select-private-space.adoc[tag=selectAppsPage]
. Click the application name.
. In the navigation menu, click *Schedules*:
+
Runtime Manager lists the Scheduler elements in the order they appear in your application:
+
<update screenshot>
+
image::ch2-scheduler-rtm.png[Last Run column, frequency link, and the Logs option on the Schedules page]
+
The *Last Run* column shows the date and time each Scheduler element last ran.
The frequency link in the *Schedule* column shows the schedule for the element.
You can click *Logs* in the left navigation menu to see more information about when the jobs started and ended scheduled runs.
. Select the elements to manage and then click the frequency link to open the schedule editor.
. In the schedule editor, change the frequency of the schedule or deselect *Enabled* to disable the schedule:
+
image::ch2-scheduler-frequency.png[Change the frequency in the schedule editor]
The value for the frequency can be between 1 and 100 seconds.
The minimum recommended frequency between calls is 10 seconds.
+
To use cron expressions to create more specific schedules,
such as every Thursday at 3:00 pm, click *Switch to advanced mode*.
See <<use_cron>>.

. Click *Update* to save changed settings or click *Cancel* to exit without saving.

== Run the Scheduled Job Immediately

If a job runs nightly but you want to debug it now, you can trigger the job
while it's running without updating the schedule in your application.

To override the schedule and run the job immediately:

// SELECT RTM APPS SHARED
include::partial$select-private-space.adoc[tag=selectAppsPage]
. Click the application name.
. In the navigation menu, click *Schedules*.
. Select the elements to manage and then click *Run now*.

== Disable or Enable a Scheduler Element 

You might want to disable a scheduled job an applications
you are connecting to is undergoing maintenance and reenable it after.

CloudHub 2.0 does not run the scheduled job until you reenable the Scheduler.

To disable the Scheduler element:

// SELECT RTM APPS SHARED
include::partial$select-private-space.adoc[tag=selectAppsPage]
. Click the application name.
. In the navigation menu, click *Schedules*.
. Select the elements to manage and then click the frequency link in the *Schedule* column to open the schedule editor.
+
In the schedule editor, deselect or select *Enabled* to disable or enable the schedule.
+
image::ch2-scheduler-enable.png[Enabled toggle in the schedule editor]


[[use_cron]]
== Use Cron Expressions

With cron expressions, you can create more complex schedule frequencies,
such as every 5 minutes between 9:00 am and 10:00 on Fridays.

To use cron expressions to specify the schedule frequency:

. In the schedule editor, click *Switch to advanced mode*.
. In the advanced mode page, click *Quick reference* to expand or collapse the table that lists required fields and allowed values:
+
image::ch2-scheduler-cron.png[Quick reference toggle, the more link, and the Switch to basic mode link on the advanced mode page]
+
The cron expression in this example sets the schedule to every 10 seconds.
+
On this page:

* Click *more* to view the http://www.quartz-scheduler.org/documentation[Quartz documentation^] (link out from Beta docs) for information about building cron triggers.
+
Select a version, click *Documentation > User's Guide > Tutorial*, and then click the *CronTrigger* lesson.
+
[NOTE]
Because all schedules are based in the UTC timezone, the timezone configuration is ignored.
* Click *Switch to basic mode* to exit advanced mode.
. Click *Update* to save changed cron settings or click *Cancel* to exit without saving.

== See Also

* xref:ch2-deploy.adoc[Deploy Apps to CloudHub 2.0]
* https://docs.mulesoft.com/mule-runtime/4.3/scheduler-concept[Scheduler Endpoint (Trigger)^] (link out from Beta docs)
* http://www.quartz-scheduler.org/documentation[Quartz documentation^] (link out from Beta docs)
* https://anypoint.mulesoft.com/exchange/?view=grid&type=example&search=&organizationId=68ef9520-24e9-4cf2-b2f5-620025690913[Example Assets provided by MuleSoft^] (link out from Beta docs)

